<html>

<head>
    <title>Ajax Image Upload Using PHP and jQuery</title>
    <!--<link rel="stylesheet" href="style.css" />-->
    <!--<link href='http://fonts.googleapis.com/css?family=Roboto+Condensed|Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>-->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!--<script src="js/guitar-test.js"></script>-->
</head>

<body>
    <div class="main">
        <h1>Ajax Image Upload</h1><br/>
        <hr>
        <form id="uploadimage" action="controller/uploadPicture.php" method="post" enctype="multipart/form-data">
            <div id="image_preview"><img id="previewing" src="img/user.png" /></div>
            <hr id="line">
            <div id="selectImage">
                <label>Select Your Image</label><br/>
                <input type="file" name="file" id="file" required />
                <input type="submit" id='upPic' value="Upload" class="submit" />
            </div>
        </form>
    </div>
    <h4 id='loading'>loading..</h4>
    <div id="message"></div>
</body>

<script>
    $(document).ready(function(e) {
        // $("#uploadimage").on('submit', (function(e) {
        //     // e.preventDefault();
        //     alert("ASD");
        //     return true;
        // }));
        // Function to preview image after validation
        $(function() {
            $("#file").change(function() {
                $("#message").empty(); // To remove the previous error message
                var file = this.files[0];
                var imagefile = file.type;
                var match = ["image/jpeg", "image/png", "image/jpg"];
                if (!((imagefile == match[0]) || (imagefile == match[1]) || (imagefile == match[2]))) {
                    $('#previewing').attr('src', 'noimage.png');
                    $("#message").html("<p id='error'>Please Select A valid Image File</p>" + "<h4>Note</h4>" + "<span id='error_message'>Only jpeg, jpg and png Images type allowed</span>");
                    return false;
                } else {
                    var reader = new FileReader();
                    reader.onload = imageIsLoaded;
                    reader.readAsDataURL(this.files[0]);
                    alert(file.name + " >< " + reader.result);
                    alert($('#file').val());
                    return true;
                }
            });
        });

        function imageIsLoaded(e) {
            $("#file").css("color", "green");
            $('#image_preview').css("display", "block");
            $('#previewing').attr('src', e.target.result);
            $('#previewing').attr('width', '250px');
            $('#previewing').attr('height', '230px');
        };
    });
</script>

</html>